// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace Blazorwasm.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/_Imports.razor"
using Blazorwasm;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/Pages/Project.razor"
using Blazor.Diagrams;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/Pages/Project.razor"
using Blazor.Diagrams.Core.Anchors;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/Pages/Project.razor"
using Blazor.Diagrams.Core.Geometry;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/Pages/Project.razor"
using Blazor.Diagrams.Core.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/Pages/Project.razor"
using Blazor.Diagrams.Core.PathGenerators;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/Pages/Project.razor"
using Blazor.Diagrams.Core.Routers;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/Pages/Project.razor"
using Blazor.Diagrams.Options;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/Pages/Project.razor"
using Blazor.Diagrams.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/Pages/Project.razor"
using Blazorwasm.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/Pages/Project.razor"
using Blazorwasm.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/Pages/Project.razor"
using Blazor.Diagrams.Core.Models.Base;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/project")]
    public partial class Project : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 25 "/Users/zhangyuanpu/Documents/CSharp/Blazorwasm/Pages/Project.razor"
       
    public IJSRuntime JSRuntime { get; set; }

    public BlazorDiagram Diagram { get; } = new BlazorDiagram(new BlazorDiagramOptions());

        public void Dispose()
        {
            Diagram.Links.Added -= OnLinkAdded;
            Diagram.Links.Removed -= Diagram_LinkRemoved;
        }

        protected override void OnInitialized()
        {
            base.OnInitialized();

            Diagram.RegisterComponent<Table, TableNode>();
            Diagram.Nodes.Add(new Table());

            Diagram.Links.Added += OnLinkAdded;
            Diagram.Links.Removed += Diagram_LinkRemoved;
        }

        private void OnLinkAdded(BaseLinkModel link)
        {
            link.TargetChanged += OnLinkTargetPortChanged;
        }

        private void OnLinkTargetPortChanged(BaseLinkModel link, Anchor oldPort, Anchor newPort)
        {
            link.Labels.Add(new LinkLabelModel(link, "1..*", -40, new Point(0, -30)));
            link.Refresh();
        }

        private void Diagram_LinkRemoved(BaseLinkModel link)
        {
            link.TargetChanged -= OnLinkTargetPortChanged;
        }


        private void NewTable()
        {
            Diagram.Nodes.Add(new Table());
        }

        private void Debug()
        {
            Console.WriteLine(Diagram.Container);
            foreach (var port in Diagram.Nodes.ToList()[0].Ports)
                Console.WriteLine(port.Position);
        }

#line default
#line hidden
#nullable disable
    }
}
#pragma warning restore 1591
